---
title: Обновление сведений о конфигурации с помощью службы автообнаружения
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.localizationpriority: medium
ms.assetid: c2f3c6a5-e8ea-4375-b41a-686a6f238d33
description: Узнайте, как и когда обновить сведения о конфигурации для Exchange подключения с помощью автооткрытия.
ms.openlocfilehash: 0ec6910fcd8ab66085de2414f02a4f78419ec78b
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2021
ms.locfileid: "59513117"
---
# <a name="refresh-configuration-information-by-using-autodiscover"></a>Обновление сведений о конфигурации с помощью службы автообнаружения

Узнайте, как и когда обновить сведения о конфигурации для Exchange подключения с помощью автооткрытия.
  
Когда приложение EWS запускается впервые, автообнаружить предоставляет отличный способ для сбора информации, необходимой для подключения к Exchange почтовому ящику пользователя. Но автонаружить не только в первый раз. Регулярное использование автооткрывающих данных помогает поддерживать подключение приложения, позволяя ему реагировать на изменения Exchange развертывания.
  
## <a name="cache-autodiscover-endpoint-and-ews-settings"></a>Конечная точка кэша и параметры EWS
<a name="bk_CacheSettings"> </a>

Хотя мы рекомендуем регулярно использовать автооткрытие, необходимо учитывать, как регулярно вы используете его. В идеале можно уравновешить быстрое реагирование на изменения в среде и создание слишком много ненужного сетевого трафика. Когда приложение впервые получит успешный ответ автообнаружение, необходимо сохранить следующую информацию, чтобы при каждом отправке запроса EWS не повторять процесс автообнаружия.
  
**Таблица 1. Сведения для кэша запросов автооткрытия**

|**Настройка кэша**|**Допустимо для...**|**Сведения**|
|:-----|:-----|:-----|
|Конечная точка автооткрытия  <br/> |До тех пор, пока он работает  <br/> |Если вы сохраните конечную точку автооткрытия, которая вернула [](how-to-generate-a-list-of-autodiscover-endpoints.md) успешный ответ, вам не придется повторять процесс создания списка конечных точек автооткрытия и их попыток до тех пор, пока вы не получите успешный ответ.<br/><br/> **ПРИМЕЧАНИЕ.** Управляемый API EWS не поддерживает кэшинг конечной точки автооткрытия.           |
|URL-адрес EWS и любые другие параметры, извлеченные из ответа автооткрытия  <br/> |Одна неделя  <br/> |Сэкономив URL-адрес EWS и другие связанные [](how-to-get-user-settings-from-exchange-by-using-autodiscover.md) параметры, вам не придется отправлять новый запрос автообнаружении для каждого запроса EWS или при перезапуске приложения. Однако, даже если URL-адрес EWS работает для пользователя, может быть доступен сервер, который является более оптимальным.<br/><br/> Например, почтовый ящик пользователя мог быть перемещен на новый сервер почтовых ящиков, что привело к новой предпочтительной конечной точке EWS. Мы рекомендуем обновить параметры пользователя, отправив новый запрос автооткрытия после того, как прошло неделю с момента последнего запроса на автонаружений. Это время может быть скорректировано, чтобы соответствовать требованиям приложения.  <br/> |
   
## <a name="refresh-cached-configuration-information"></a>Обновление кэшных сведений о конфигурации
<a name="bk_RefreshConfig"> </a>

Теперь, когда вы кэшировали сведения, давайте рассмотрим, как сохранить этот кэш свежим. Рекомендуется обновить кэшную информацию, если:
  
- Срок действия сведений истекает.
    
- Возникает [ошибка, связанная с](#bk_ConnectionErrors) подключением, и кэшировали данные, которые последний раз обновлялись более часа назад.
    
Чтобы обновить кэшную информацию, отправьте запрос автооткрытия в конечную точку кэшного автооткрытия и сделайте следующее:
  
- Если запрос удался, сравните конечную точку EWS в ответе с кэшной конечной точкой EWS и сделайте следующее:
    
  - Если они отличаются, используйте новую конечную точку EWS. Если вы освежаете восстановление после ошибки, повторно обновим неудачный запрос с помощью новой конечной точки.
    
  - Если они одинаковы, продолжайте использовать исходную конечную точку EWS. Если вы хотите восстановиться после ошибки, справитесь с ошибкой по мере необходимости.
    
- Если запрос не удается, [](autodiscover-for-exchange.md) запустите процесс автонаружия с самого начала. После успешного ответа замените конечную точку автооткрытия кэшом на конечную точку автооткрытия, которая успешно прошла успешно и продолжает использовать новую конечную точку EWS. Если вы не получите успешный ответ, продолжайте использовать исходную конечную точку автооткрытия и конечную точку EWS. Если вы хотите восстановиться после ошибки, справитесь с ошибкой по мере необходимости. 
    
На следующем рисунке обеспечивается визуальное представление этого процесса.
  
**Рис. 1. Процесс обновления сведений о конфигурации с помощью автооткрытия**

![Схема обновления данных конфигурации при автообнаружении.](media/Ex15_Autodiscover_Refresh_Flowchart.png)
  
### <a name="connection-related-errors"></a>Ошибки, связанные с подключением
<a name="bk_ConnectionErrors"> </a>

Обновление кэширования сведений о конфигурации может помочь с некоторыми ошибками, но не со всеми. 
  
**Таблица 2. Ошибки, устраненные путем обновления кэша**

|**Ошибка**|**Реализация управляемого API EWS**|**Примечания**.|
|:-----|:-----|:-----|
|Ошибки DNS или сбои в сети<br/><br/> Пример. Имя хозяина не удалось найти.  <br/> |[ServiceRemoteException](https://docs.microsoft.com/dotnet/api/microsoft.exchange.webservices.data.serviceremoteexception?view=exchange-ews-api) <br/> |Любая ошибка, которая указывает на то, что сервер не удалось найти или не удалось достичь, может быть устранена с помощью автооткрытия. <br/><br/> Конечная точка кэшировали EWS, возможно, больше не допустима, и автономная точка может указать на новый сервер.  <br/> |
|Ошибки состояния HTTP<br/><br/> Пример: недоступность службы 503  <br/> |[ServiceRemoteException](https://docs.microsoft.com/dotnet/api/microsoft.exchange.webservices.data.serviceremoteexception?view=exchange-ews-api) <br/> |Ошибки состояния HTTP могут происходить по разным причинам.<br/><br/> Однако стоит попробовать автооткрыть, чтобы узнать, доступна ли новая конечная точка EWS для пользователя.  <br/> |
|Коды ошибок EWS <br/><br/> Пример: ErrorConnectionFailed <br/> |[ResponseCodeType](../web-service-reference/responsecode.md) <br/> | Большинство кодов ошибок EWS не требуют обновления сведений о конфигурации.<br/><br/> Однако следующие сведения о конфигурации должны быть обновлены.<br/>- **ErrorConnectionFailed** <br/>- **ErrorMailboxMoveInProgress** <br/> |
   
## <a name="see-also"></a>См. также

- [Автообнаружение в Exchange](autodiscover-for-exchange.md)  
- [Создание списка конечных точек автообнаружения](how-to-generate-a-list-of-autodiscover-endpoints.md)   
- [Получение параметров пользователя из Exchange с помощью службы автообнаружения](how-to-get-user-settings-from-exchange-by-using-autodiscover.md)
    

