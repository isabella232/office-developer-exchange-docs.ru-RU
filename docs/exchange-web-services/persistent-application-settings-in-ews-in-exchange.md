---
title: Параметры сохраняемого приложения в веб-службах Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.localizationpriority: medium
ms.assetid: 394d4e70-8517-4073-809a-5b61780ff923
description: Узнайте о различных вариантах, которые может использовать ваше приложение управляемый API или EWS для создания настойчивых параметров настраиваемого приложения в Exchange.
ms.openlocfilehash: 3fdc7ad3d5acabf6b498743afe8d93f0eff048c3
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2021
ms.locfileid: "59516140"
---
# <a name="persistent-application-settings-in-ews-in-exchange"></a>Параметры сохраняемого приложения в веб-службах Exchange

Узнайте о различных вариантах, которые может использовать ваше приложение управляемый API или EWS для создания настойчивых параметров настраиваемого приложения в Exchange.
  

  
Самый простой способ синхронизировать настраиваемые конфигурации клиентов для почтового ящика или папок и элементов в почтовом ящике — хранить параметры приложений на Exchange сервере. Вы можете убедиться, что эти параметры сохраняются для почтового ящика с помощью одного из следующих параметров: 
  
- Объекты конфигурации пользователя
    
- Расширенные свойства
    
- Настраиваемые элементы
    
## <a name="what-are-my-options-for-creating-persistent-application-settings"></a>Каковы мои возможности создания настойчивых параметров приложения?
<a name="Options"> </a>

Объекты конфигурации пользователей — это оптимальный вариант для хранения параметров конфигурации для ваших клиентских приложений EWS. Вы также можете использовать расширенные свойства или настраиваемые элементы или сочетание всех трех. Выберите параметр, основанный на области параметров и на том, должны ли параметры быть доступными для других приложений.
  
**Таблица 1. Рекомендуемые варианты создания настойчивых параметров приложения на основе области**

|**Настройка области**|**Применение**|**Доступ к**|
|:-----|:-----|:-----|
|Item  <br/> |Расширенное свойство существующего элемента.  <br/> |Любое приложение EWS. Доступ к расширенному свойству могут получить только клиенты EWS, которые знают идентификатор свойства.  <br/> |
|Folder  <br/> |Объект конфигурации пользователя в целевой папке. Это хороший способ сохранить параметры представления для папки.  <br/> |Любое приложение EWS.  <br/> |
|Mailbox  <br/> |Объект конфигурации пользователя в папке msgrootfolder по умолчанию.  <br/> |Любое приложение EWS.  <br/> |
   
### <a name="user-configuration-objects"></a>Объекты конфигурации пользователя
<a name="UserConfig"> </a>

Объекты конфигурации пользователей — это специальные элементы, связанные с папками в почтовом ящике. Объекты конфигурации пользователей, также известные как связанные с папками элементы, как правило, являются наилучшим вариантом для сохраняющихся параметров приложения, особенно если сведения о конфигурации связаны с папкой или почтовым ящиком. Обычно они не всплыли для конечных пользователей. Поскольку они могут хранить потоки данных и словари данных, они идеально подходят для хранения сведений о конфигурации. Лучший способ использования объектов конфигурации пользователя — хранить набор конфигураций в XML-документе, а затем сохранять эти сведения в одном из свойств потока конфигурации пользователя.
  
Доступ к объектам конфигурации пользователей отличается от других типов элементов, хранимых в почтовом ящике. Вы можете использовать метод Управляемый API [folder.FindItems](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=EXCHG.80%29.aspx) EWS или операцию [FindItem](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) EWS для поиска всех элементов, но для поиска объектов конфигурации пользователя необходимо использовать параметр Associated **Search** traversal. **Связанный** обход поиска указывает, что результаты поиска должны содержать только объекты конфигурации пользователя. EWS включает в себя набор операций, которые относятся к объектам конфигурации пользователя. 
  
**Таблица 1. Операции EWS и методы управляемого API EWS для работы с объектами конфигурации пользователей**

|**Задача**|**Используйте эту операцию EWS**|**Используйте этот метод управляемого API EWS**|
|:-----|:-----|:-----|
|Создание объекта конфигурации пользователя  <br/> |[Операция CreateUserConfiguration](https://msdn.microsoft.com/library/eb5b8ab6-9743-481c-aac9-f9aa889bd353%28Office.15%29.aspx) <br/> |[UserConfiguration.Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.userconfiguration.save%28v=exchg.80%29.aspx) <br/> |
|Получить объект конфигурации пользователя  <br/> |[Операция GetUserConfiguration](https://msdn.microsoft.com/library/71d50e3c-92bd-435f-8118-b28bb85f8138%28Office.15%29.aspx) <br/> |[UserConfiguration.Bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.userconfiguration.bind%28v=exchg.80%29.aspx) <br/> [UserConfiguration.Load](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.userconfiguration.load%28v=exchg.80%29.aspx) <br/> |
|Обновление объекта конфигурации пользователя  <br/> |[Операция UpdateUserConfiguration](https://msdn.microsoft.com/library/eda73b62-6a3a-43ae-8fd9-f30892811f27%28Office.15%29.aspx) <br/> |[UserConfiguration.Update](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.userconfiguration.bind%28v=exchg.80%29.aspx) <br/> |
|Удаление объекта конфигурации пользователя  <br/> |[Операция DeleteUserConfiguration](https://msdn.microsoft.com/library/93e44690-be2d-4fdb-96a8-4ded3c193aed%28Office.15%29.aspx) <br/> |[UserConfiguration.Delete](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.userconfiguration.delete%28v=exchg.80%29.aspx) <br/> |
   
> [!NOTE]
> Объекты конфигурации пользователей, созданные с помощью EWS, имеют префикс [ItemClass,](https://msdn.microsoft.com/library/56020078-50b4-4880-894a-a9f234033cfb%28Office.15%29.aspx) который начинается с "IPM. Configuration.". **ItemClass объекта** конфигурации пользователя — это префикс объекта конфигурации пользователя и имя объекта конфигурации пользователя. Для поиска определенных объектов конфигурации пользователя можно использовать свойство Управляемый API [Item.ItemClass](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.userconfiguration.delete%28v=exchg.80%29.aspx) EWS или элемент **ItemClass** EWS. 
  
### <a name="extended-properties"></a>Расширенные свойства
<a name="ExtendedProperties"> </a>

Используйте [расширенные свойства для](properties-and-extended-properties-in-ews-in-exchange.md) хранения сведений о конфигурации элементов. EWS, в отличие от MAPI, не возвращает пакет свойств для элементов. Это означает, что клиент EWS должен знать расширенный идентификатор свойства, чтобы найти расширенное свойство и получить доступ к нему. Если вам необходимо хранить сведения о конфигурации для элементов, не в том что касается объектов конфигурации пользователя, решением может стать использование расширенных свойств для создания настраиваемого свойства. Расширенные свойства позволяют получать доступ и хранить сведения о свойствах, которые не являются частью стандартного набора свойств для элемента. 
  
> [!IMPORTANT]
> Схема Exchange базы данных имеет конечное число свойств. Максимальное число идентификаторов свойств для Exchange базы данных — 32 767. Если вы используете расширенные свойства для хранения многих параметров, мы предлагаем использовать одно расширенное свойство для хранения этих параметров, чтобы не превышать этот максимум. 
  
Для набора расширенных свойств объектов конфигурации пользователей можно использовать метод Управляемый API [Item.Update](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.update%28v=EXCHG.80%29.aspx) EWS или операцию [UpdateItem](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) EWS. 
  
### <a name="custom-items"></a>Настраиваемые элементы
<a name="CustomItems"> </a>

Настраиваемые элементы также можно использовать для хранения информации. Существующие свойства элементов можно повторно использовать для размещения сведений о конфигурации. Или можно использовать расширенные свойства для определения собственных свойств для приложения. Использование настраиваемой конфигурации для хранения элементов обеспечивает следующие преимущества: 
  
- Они работают для всех версий Exchange, которые поддерживают EWS.
    
- Если на элементе не используются расширенные свойства, Exchange не взимается.
    
## <a name="where-should-i-store-my-application-settings"></a>Где хранить параметры приложения?
<a name="ApplicationSettingsLocation"> </a>

Папки почтовых ящиков и элементы внутри них находятся в корневой папке сообщений. Эта папка определена [значением WellKnownFolderName.msgfolderroot](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.wellknownfoldername%28v=exchg.80%29.aspx) в управляемом API EWS. В терминах MAPI это эквивалент подтрия IPM почтового ящика. Объекты конфигурации пользователя часто используются для создания параметров на основе пользовательского интерфейса, чтобы приложение могли отрисовки параметров представления на основе папки, к которую пользователь получает доступ. Параметры представления на основе папок обычно устанавливаются на объекте конфигурации пользователя, связанном с папкой. Но иногда может потребоваться сделать параметры глобальными для приложения. В этом случае можно хранить параметры в корневой папке сообщений. 
  
Большинство пользователей не знают и обычно не имеют доступа к корневой папке почтовых ящиков. Эта папка определена [значением WellKnownFolderName.root](https://msdn.microsoft.com/library/office/microsoft.exchange.webservices.data.wellknownfoldername%28v=exchg.80%29.aspx) в управляемом API EWS. С точки зрения MAPI это эквивалент подтриба без IPM почтового ящика. Сведения о том, что конечные пользователи не имеют непосредственного доступа, хранятся в корневой папке почтовых ящиков. Возможно, вам нужно сохранить параметр приложения в этой папке, так как клиентские приложения обычно не имеют к нему доступа. 
  
## <a name="version-differences"></a>Различия версий
<a name="VersionDifferences"> </a>

Объекты конфигурации пользователей доступны Exchange Online, Exchange Online в Office 365, а также версии Exchange начиная с Exchange 2010 года.
  
## <a name="see-also"></a>См. также


- [Управление настойчивыми настройками приложений с помощью EWS в Exchange](how-to-manage-persistent-application-settings-by-using-ews-in-exchange.md)
    
- [Общие сведения о разработке клиента EWS для Exchange](ews-client-design-overview-for-exchange.md)
    
- [Свойства и расширенные свойства в веб-службах Exchange](properties-and-extended-properties-in-ews-in-exchange.md)
    
- [Работа с папками с помощью EWS в Exchange](how-to-work-with-folders-by-using-ews-in-exchange.md)
    
- [Работа с элементами почтовых ящиков Exchange с помощью веб-служб Exchange](how-to-work-with-exchange-mailbox-items-by-using-ews-in-exchange.md)
    

