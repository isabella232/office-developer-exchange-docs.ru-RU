---
title: Exchange в Exchange 2013 г.
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
ms.localizationpriority: medium
ms.assetid: ec126433-9f0a-46ec-a685-ff4af2f97bc1
description: Сведения о записи Exchange в Exchange 2013 г. для операций резервного копирования и восстановления.
ms.openlocfilehash: 7c50c2aa014308b05bdbc1acf0f2a91e33717ed6
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2021
ms.locfileid: "59516239"
---
# <a name="exchange-writer-in-exchange-2013"></a>Exchange в Exchange 2013 г.

Сведения о записи Exchange в Exchange 2013 г. для операций резервного копирования и восстановления. 
  
**Применяется к:** Exchange Server 2013 г. 
  
Автор Exchange отвечает за резервное копирование и восстановление активных баз данных Exchange Server 2013 г. Автор Exchange также поддерживает функции резервного копирования для выбранной базы данных, в которой теневая копия передается в реплицированный экземпляр файлов базы данных и журналов транзакций. 
  
## <a name="overview-of-the-exchange-writer"></a>Обзор записи Exchange
<a name="bk_Overview"> </a>

Exchange 2013 г. включает функции мобильности баз данных, которые позволяют реплицировать базы данных между различными серверами Exchange для повышения доступности баз данных и устойчивости сайта. Другие копии баз данных в группе доступности баз данных (DAG) предоставляют ценную возможность для Exchange резервных копий использовать дополнительные ресурсы, доступные в расположении копии. Кроме того, поскольку копия вместо активного мастера базы данных резервного копирования, копия может быть недоступна во время резервного копирования в течение более длительного периода времени. 
  
Автор Exchange координирует работу с службами Exchange (работающими от имени запрашиваемого пользователя) для подготовки файлов баз данных для резервного копирования, замораживает действия IO в результате транзакций Exchange до резервного копирования базы данных, а затем разморозит и усечение файлов журналов после завершения резервного копирования.
  
Во время восстановления приложение резервного копирования и восстановления инструктирует автора Exchange скоординироваться с хранилищем Exchange (работающим от имени запрашиваемого пользователя), чтобы проверить цели восстановления, при необходимости переименовать файл базы данных и при необходимости повторить журналы транзакций. Автор Exchange поддерживает как резервное копирование, так и восстановление.
  
Автор Exchange доступен на любом Exchange, на который установлена роль сервера почтовых ящиков. 
  
## <a name="exchange-writer-configuration-settings"></a>Exchange настройки сочинителя
<a name="bk_ExchangeWriterConfig"> </a>

Автор Exchange vsS использует множество параметров и значений, которые необходимо правильно установить и сохранить во время операций резервного копирования и восстановления. Эти параметры конфигурации хранятся в документе метаданных Exchange автора. Если приложение резервного копирования не сохраняет эти параметры, при попытке резервного копирования Exchange баз данных могут возникнуть непредвиденные ошибки. 
  
В следующей таблице перечислены интерфейсы VSS, которые раскрывают метаданные об компонентах резервного копирования баз данных. Эти интерфейсы необходимы для получения документа метаданных Exchange автора, который используется для выполнения резервного копирования Exchange магазина.
  
**Таблица 1. Интерфейсы VSS**

|**Интерфейс VSS**|**Описание**|
|:-----|:-----|
|IVssWMComponent  <br/> |Позволяет получить доступ к сведениям о компонентах, хранимым в Exchange писатель.  <br/> |
|IVssExamineWriterMetadata  <br/> |Позволяет запрашивать резервное копирование и восстановление приложения для проверки метаданных Exchange автора. Документ метаданных Exchange-записи содержит Exchange 2013 г. значения и параметры, необходимые приложению для резервного копирования и восстановления, чтобы правильно указать соответствующие компоненты для резервного копирования.  <br/> |
|IVssComponent  <br/> |Содержит методы изучения и изменения сведений о компонентах, содержащихся в документе резервного копирования. Объекты можно получить только для тех компонентов, которые были явно добавлены в этот документ методом [IVssBackupComponents::AddComponent.](https://msdn.microsoft.com/library/windows/desktop/aa382646%28v=vs.85%29.aspx)  <br/> |
|IVssBackupComponents  <br/> |Используется приложением резервного копирования и восстановления для опроса Exchange о состоянии файла и для запуска операций резервного копирования и восстановления. Метод [IVssBackupComponents::SetBackupState ](https://msdn.microsoft.com/library/windows/desktop/aa382833%28v=vs.85%29.aspx) определяет, является ли операция резервного копирования полной, копированием, инкрементной или дифференциальной резервной копией. Метод [IVssBackupComponents::AddRestoreSubcomponent](https://msdn.microsoft.com/library/windows/desktop/aa382649%28v=vs.85%29.aspx) определяет подкомпоненты базы данных Exchange 2013 г., которые можно выбрать для операции восстановления.  <br/> |
   
В файловой системе Windows Server база данных Exchange 2013 года хранится как единый файл базы данных с расширением *.edb. Автор Exchange предоставляет *.edb** в качестве компонента базы данных, в то время как журналы транзакций (.log) и файлы контрольно-пропускных пунктов (chk) объединяются в один компонент, именуемый компонентом журнала. Дополнительные сведения о Exchange базах данных см. в материалах [Backup and restore concepts for Exchange 2013 .](backup-and-restore-concepts-for-exchange-2013.md)
  
## <a name="interactions-between-the-exchange-writer-vss-and-vss-requesters"></a>Взаимодействие между автором Exchange, vsS и запросителями VSS
<a name="bk_interactions"> </a>

Взаимодействие на высоком уровне между VSS, Exchange и Exchange 2013 г. во время операций резервного копирования:
  
1. Программа (или агент) архивации запускает запланированное задание. 
    
2. Запроситель VSS в приложении резервного копирования и восстановления отправляет команду в VSS, чтобы взять теневую копию выбранных Exchange 2013 года. 
    
3. VSS взаимодействует с автором Exchange, чтобы подготовиться к резервному копированию снимков. Exchange 2013 г. запрещает административные действия в отношении баз данных, проверяет зависимости от объема и приостанавливать все операции записи в выбранный экземпляр файлов базы данных и журналов транзакций, разрешая доступ только для чтения. 
    
4. VSS взаимодействует с соответствующим поставщиком хранилища, чтобы создать теневую копию тома хранилища, содержаного Exchange базы данных 2013 г. 
    
5. Выпуск vsS Exchange 2013 г. для возобновления обычных операций. 
    
6. Запрашивающий запрос VSS проверяет физическую согласованность набора резервного копирования до сигнала об успешном резервном копировании. Exchange 2013 г. усечены журналы транзакций (если база данных является частью DAG, truncation журнала реплицируется среди всех копий) и записывания времени последнего резервного копирования для базы данных.
    
VSS сериализирует взаимодействие запросчиков с Exchange, начиная с метода [OnPrepareBackup](https://msdn.microsoft.com/library/windows/desktop/aa381571%28v=vs.85%29.aspx) и заканчивая методом [OnPostSnapshot.](https://msdn.microsoft.com/library/windows/desktop/aa381568%28v=vs.85%29.aspx) Как правило, большинство времени, Exchange, которое писатель тратит на работу с теневой копией, происходит после метода **OnPostSnapshot,** когда согласованность теневой копии проверяется до завершения резервного копирования. Автор Exchange поддерживает параллельные резервные копии **между OnPostSnapshot** и [OnBackupComplete.](https://msdn.microsoft.com/library/windows/desktop/aa381557%28v=vs.85%29.aspx)
  
Exchange 2013 г. не допускает одновоментное резервное копирование одной базы данных. Только одно задание резервного копирования может работать одновременно с данной базой данных. При запуске резервного копирования Exchange хранилище помещает базу данных в состояние резервного копирования. Это состояние в памяти очищается либо при завершении процесса резервного копирования, либо при перезапуске службы. Состояние резервного копирования в памяти и связанные с ним данные теряются при перезапуске службы Exchange, перезапуске операционной системы или при сбойе кластера. Любое из этих событий приведет к сбой задания резервного копирования.
  
Truncation файла журнала журнала транзакций с инициированной резервной копией запускается в зависимости от типа выполняемой резервной копии. В конфигурациях, не Exchange DAG, Exchange будет усечены файлы журнала транзакций по завершении успешного полного или постепенного резервного копирования. В реплицируемых конфигурациях DAG truncation журнала будет отложен службой репликации до тех пор, пока все необходимые файлы журнала не будут воспроизведены во все другие копии. Служба репликации удаляет архивированные файлы журналов как из активных, так и из путей файлов журнала копирования после того, как будет установлено, что файлы журналов успешно применены к базе данных копий, и как активная база данных, так и контрольно-пропускной пункт копий баз данных прошли удаленные файлы журнала.
  
## <a name="see-also"></a>См. также

- [Журналы транзакций и файлы контрольно-пропускных пунктов для резервного копирования и восстановления Exchange 2013 г.](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [Концепции резервного копирования и восстановления Exchange 2013 г.](backup-and-restore-concepts-for-exchange-2013.md)
    

