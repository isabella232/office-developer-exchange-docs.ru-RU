---
title: Создание приложений резервного копирования и восстановления для Exchange 2013 г.
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
ms.localizationpriority: medium
ms.assetid: e5e952a5-add1-417c-a3c2-230f4dc99b00
description: Сведения о компонентах и архитектуре приложений резервного копирования и восстановления для Exchange 2013 г., а также требования системы для создания резервного копирования и восстановления приложения.
ms.openlocfilehash: 590ac029e157196d370cbcbe54e5df75bc1a830b
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2021
ms.locfileid: "59513880"
---
# <a name="build-backup-and-restore-applications-for-exchange-2013"></a>Создание приложений резервного копирования и восстановления для Exchange 2013 г.

Сведения о компонентах и архитектуре приложений резервного копирования и восстановления для Exchange 2013 г., а также требования системы для создания резервного копирования и восстановления приложения.
  
**Применяется к:** Exchange Server 2013 г. 
  
Службу копирования теней тома [(VSS)](https://msdn.microsoft.com/library/bb968832%28VS.85%29.aspx) можно использовать в версиях Windows Server, начиная с Windows Server 2008, для создания приложений, которые восстанавливают и восстанавливают данные Exchange Server 2013 г. VSS предоставляет инфраструктуру, которая позволяет создавать и управлять теневыми копиями в сторонних системах управления хранилищами, бизнес-приложениях и оборудовании. Можно создавать решения на основе инфраструктуры VSS, которая использует теневые копии для создания и восстановления одной или Exchange баз данных 2013 г. 
  
## <a name="backup-and-restore-application-prerequisites"></a>Предварительные условия резервного копирования и восстановления приложений
<a name="bk_systemrequirements"> </a>

Для резервного копирования и восстановления пользовательского приложения и vsS для резервного копирования и восстановления баз данных Exchange 2013 г., среда должна включать следующие:
  
- Версия Windows Server, начиная с Windows Server 2008 
    
- Exchange 2013
    
Кроме того, при создании приложения резервного копирования и восстановления следует помнить о следующих ограничениях среды разработки:
  
- VSS — это неуправимый API com, к которым можно получить доступ платформа .NET Framework управляемого кода с помощью сборки com Interop.
    
- Оболочка Exchange управления — это управляемое приложение, к нему можно получить доступ платформа .NET Framework управляемым кодом.
    
- API CHKSGFILES, поставляемая с Exchange 2013 г., — это 64-битная DLL родного кода. Использование Exchange 32-битной DLL CHKSGFILES 2007 Exchange 2013 г. не поддерживается.
    
## <a name="backup-and-restore-application-overview"></a>Обзор резервного копирования и восстановления приложений
<a name="bk_components"> </a>

VSS координирует связь между следующими компонентами: 
  
- Запросник VSS, который является вашим приложением резервного копирования
    
- Автор VSS
    
- Поставщик VSS, который является компонентами системы, программного обеспечения или оборудования, создающих теневые копии
    
Чтобы использовать VSS для резервного копирования данных Exchange 2013 г., резервное приложение должно быть Exchange 2013 года. Exchange 2013 г. для программы резервного копирования Exchange Microsoft Windows Server; однако автор Exchange только возвращает целые тома. Он не возвращает отдельные базы данных Exchange 2013 года. Если требуется больше гибкости, можно использовать стороннее резервное приложение с Exchange автором VSS, которое может работать с отдельными Exchange базами данных, или создать настраиваемый запрос vsS.
  
Прежде чем приложение вызывает VSS для инициации резервного копирования, оно должно получить сведения о конфигурации хранилища для резервной копии Exchange 2013 года. Эти сведения хранятся в службах домена Active Directory (AD DS). Резервное приложение может получать Exchange конфигурации хранилища с помощью Exchange командной оболочки управления. Дополнительные сведения см. [в Exchange Server PowerShell (Exchange Management Shell).](https://docs.microsoft.com/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) 
  
Exchange 2013 г. приложения резервного копирования вызывали API VSS COM для создания полных, копий, дифференциальных и дополнительных резервных копий Exchange баз данных; они не взаимодействуют напрямую с автором VSS. Функциональные возможности группы доступности баз данных (DAG) в Exchange также позволяют приложению создавать полностью согласованное резервное копирование, даже если первоначальное полное резервное копирование и более позднее постепенное резервное копирование приходят с разных серверов в DAG. После создания vsS копии данных Exchange резервного копирования приложение сохраняет данные на предполагаемом носите.
  
Чтобы восстановить базу Exchange 2013 г., приложение восстановления извлекает базы данных и файлы журнала из резервного мультимедиа и хранит их на активном хранилище Exchange сервера. Отдельные базы данных не связаны с определенным Exchange сервером. 
  
Приложения для резервного копирования и восстановления должны указать ряд параметров, Exchange 2013 г., для правильного управления операциями, управляемыми VSS Exchange 2013 г. Например, поскольку Exchange 2013 г. поддерживает до 100 одновременно активных баз данных, приложение резервного копирования должно правильно указать и обработать файл базы данных, файлы журналов транзакций и компоненты базы данных контрольных пунктов.
  
Чтобы восстановить базу данных, в которой произошли изменения после последнего полного восстановления, вашему приложению для восстановления необходимы базы данных и файлы журналов из разных резервных копий. Например, для этого может потребоваться еженедельное полное резервное копирование и одно или несколько ежедневных дополнительных резервных копий. В Exchange 2013 г., использующих daGs, приложение восстановления может восстановить базу данных с помощью резервных копий из различных копий баз данных на разных серверах в том же DAG. Однако единственный поддерживаемый способ восстановления базы данных DAG из резервного копирования — это восстановление всех активных и пассивных копий базы данных с помощью тех же данных.
  
После того как все данные на месте, сигналы Exchange для проверки целостности базы данных и файлов журнала. Если база данных и файлы журналов восстановлены правильно, Exchange сервер может повторить файлы журнала баз данных, чтобы привести базу данных в порядок и установить ее. Если база данных восстановлена на сервере, на который уже установлена активная копия базы данных, база данных рассматривается как база данных восстановления. Если база данных была восстановлена на другом сервере, база данных может быть установлена самостоятельно или эта реплика может быть добавлена в DAG.
  
## <a name="backup-and-restore-system-architecture"></a>Архитектура резервного копирования и восстановления системы
<a name="bk_ExchangeVSS"> </a>

VSS взаимодействует с файловой системой Windows Server и с драйвером устройства массового хранения через сторонний (или настраиваемый) поставщик. Поставщик оборудования определяет, где будет создана теневая копия. VSS абстрагирует определенную по оборудованию теневую копию, чтобы приложение резервного копирования и восстановления могли получить доступ к теневой копии без сведений о деталях реализации оборудования. На следующем рисунке показано, как приложение резервного копирования и восстановления взаимодействует с Exchange 2013 и Windows Server.
  
**Рис. 1. Архитектура резервного копирования и восстановления системы**

![Диаграмма, показывающая взаимодействие приложений для резервного копирования и восстановления. Между Exchange, сервером Windows Server и клиентским приложением устанавливается двусторонняя связь. Сервер Windows также взаимодействует с запоминающим устройством или резервным носителем.](media/VSS_architecture_E2k7.gif)
  
Резервное копирование и восстановление приложений выполняет функции запроса VSS. Запрашиватель взаимодействует с VSS, чтобы получить сведения о Exchange 2013 г., инициировать создание теневых копий и получить доступ к данным для резервного копирования. 
  
Хранилище Exchange является компонентом Exchange 2013 г. и Exchange 2013 г. через файловую систему Windows Server. В файловой системе каждый Exchange сервер может одновременно установить до 100 баз данных с сопровождающим их файлами базы данных (.edb), файлами журналов транзакций и файлом контрольно-пропускных пунктов.
  
Для поддержки VSS Exchange 2013 включает Exchange, встроенный в Exchange магазине. Автор Exchange координирует работу с хранилищем Exchange (работающим от имени запрашиваемого пользователя), чтобы заморозить и демонтировать базу данных перед ее резервной копией, а затем разморозить и установить базу данных после завершения резервного копирования. Во время восстановления приложение резервного копирования и восстановления инструктирует автора Exchange координировать работу с хранилищем Exchange, чтобы демонтировать базу данных, заменить файлы баз данных, установить базу данных, а затем повторить журналы транзакций (по мере необходимости).
  
Во время восстановления запрашиватель также взаимодействует с VSS для подготовки системы к восстановлению, а затем возвращает данные на устройство массового хранения. Ваше приложение резервного копирования и восстановления также отвечает за работу с Windows Server для чтения данных из хранилища резервного копирования и записи данных, будь то архив ленты, сеть области хранения или другая среда резервного копирования.
  
Восстановленная база данных может быть установлена как обычная активная база данных, либо как Exchange 2013 года. Только одна установленная база данных может быть назначена в качестве базы данных восстановления на каждом Exchange сервере.
  
Сведения, необходимые для успешного выполнения операций резервного копирования и восстановления между Exchange 2013 г., VSS и приложения резервного копирования и восстановления передаются в Exchange записи.
  
## <a name="in-this-section"></a>В этом разделе:
<a name="bk_inthissection"> </a>

- [Типы операций резервного копирования Exchange 2013 г.](types-of-backup-operations-for-exchange-2013.md)
    
- [Восстановление Exchange 2013 г.](restoring-exchange-2013-databases.md)
    
- [Проверка целостности резервного копирования с помощью API CHKSGFILES в Exchange 2013 г.](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
    
- [Проверка целостности резервного копирования с помощью средства Eseutil в Exchange 2013 г.](how-to-validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013.md)
    
## <a name="see-also"></a>См. также

- [Резервное копирование и восстановление для Exchange](backup-and-restore-for-exchange-2013.md) 
- [Справочник по классу CChkSGFiles](cchksgfiles-class-reference.md) 
- [Служба теневого копирования томов](https://msdn.microsoft.com/library/bb968832%28VS.85%29.aspx) 
- [Windows PowerShell](https://msdn.microsoft.com/library/dd835506%28v=vs.85%29.aspx)
    

