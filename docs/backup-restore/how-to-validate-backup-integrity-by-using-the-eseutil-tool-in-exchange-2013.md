---
title: Проверка целостности резервного копирования с помощью средства Eseutil в Exchange 2013 г.
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
ms.localizationpriority: medium
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Узнайте, как использовать средство командной строки Eseutil для проверки резервного копирования Exchange магазина.
ms.openlocfilehash: 0ac994201d1f6c711e5d4d0a3d5835f9bac6e041
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2021
ms.locfileid: "59516225"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a>Проверка целостности резервного копирования с помощью средства Eseutil в Exchange 2013 г.

Узнайте, как использовать средство командной строки Eseutil для проверки резервного копирования Exchange магазина. 
  
**Применяется к:** Exchange Server 2013 г. 
  
Так как служба копирования теней тома (VSS) может создавать резервные копии в то время как Exchange продолжает записываться в базу данных, сервер не трогает все страницы и выполняет необходимые проверки согласованности. По этой причине любое приложение резервного копирования и восстановления, использующее VSS, должно проверять согласованность снимков. Exchange Server 2013 поддерживает следующие два метода проверки согласованности снимков: 
  
- The CHKSGFILES API
    
- Средство командной строки Eseutil
    
Рекомендуется использовать API CHKSGFILES, так как приложению резервного копирования проще обнаруживать, диагностировать и сообщать об ошибках, обнаруженных во время проверки соответствия CHKSGFILES. Сведения о том, как использовать API CHKSGFILES, см. в руб. Проверка целостности резервного копирования с помощью [API CHKSGFILES в Exchange 2013 г.](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
  
## <a name="running-the-eseutil-tool"></a>Запуск средства Eseutil

Чтобы проверить согласованность снимков, запустите команду eseutil с базой данных и файлами журналов, которые определены в следующей таблице. 
  
**Таблица 1. Eseutil.exe команд для каждого типа резервного копирования**

|**Тип файла/тип резервного копирования**|**Полное резервное копирование**|**Копирование резервного копирования**|**Постепенное резервное копирование**|**Резервное копирование дифференциала**|
|:-----|:-----|:-----|:-----|:-----|
|.edb  <br/> |"eseutil /k/i"  <br/> |"eseutil /k/i"  <br/> |Неприменимо  <br/> |Неприменимо  <br/> |
|Журнал .log  <br/> |"eseutil /k" (1)  <br/> |"eseutil /k" (1)  <br/> |"eseutil /k" (2)  <br/> |"eseutil /k" (2)  <br/> |
   
> [!NOTE]
> Вам не нужно запускать команду eseutil с файлами .stm и chk. 
  
Для восстановления базы данных снимков необходимы все файлы журнала, которые имеют номер создания файлов журнала, равный или большее, чем число генерации файла журнала контрольно-пропускных пунктов. Если он существует, для восстановления базы данных также требуется текущий файл журнала (Enn.log). Если какой-либо из необходимых файлов журнала не справился с проверкой согласованности, запрашиватель должен убедиться, что состояние компонента резервного копирования установлено false перед вызовом метода [BackupComplete.](https://msdn.microsoft.com/library/windows/desktop/aa382651%28v=vs.85%29.aspx) Чтобы определить файл журнала контрольной точки, запустите Eseutil.exe к файлу контрольной точки моментального снимка и разойдите вывод для "Checkpoint:". В следующем примере показано, как Eseutil.exe для файла контрольной точки. 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

Вторая строка в примере — это возвращающееся значение, 0x20 является номером поколения журналов hexadecimal файла журнала контрольно-пропускных пунктов. В этом примере любые файлы журнала, в том числе E010000020.log и больше, не должны быть повреждены для восстановления базы данных снимков, даже если сама база данных уже прошла проверку физической согласованности.
  
Все файлы журнала в дополнительном или дифференциалном резервном наборе необходимы для восстановления базы данных. Вы можете проверить последовательность последовательности журнала, Eseutil.exe с префиксом файла журнала. В следующем примере показано, как выполнить проверки согласованности со всеми файлами формы E01xxxxxx.log на заданном пути.
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a>Проверка Eseutil.exe вывода

Запрашиватель должен убедиться, что все возвращаемые значения ошибок ERRORLEVEL не являются ненамеренными. Сведения о значениях ERRORLEVEL см. в справке по распространенным ошибкам [Eseutil.](https://technet.microsoft.com/library/aa996759%28v=exchg.80%29.aspx) Чтобы увидеть ERRORLEVEL в командной строке, введите "эхо %errorlevel%" после Eseutil.exe завершения работы. Отрицательный ERRORLEVEL указывает на то, что один или несколько файлов повреждены.
  
Прежде чем запрашиватель вызывает метод **BackupComplete,** он должен убедиться, что состояние компонента резервного копирования отражает результат проверки согласованности. Если обнаружена коррупция, состояние будет ложным; если не обнаружено коррупции, состояние будет true. 
  
## <a name="see-also"></a>См. также

- [Проверка целостности резервного копирования с помощью API CHKSGFILES в Exchange 2013 г.](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [Создание приложений резервного копирования и восстановления для Exchange 2013 г.](build-backup-and-restore-applications-for-exchange-2013.md)
- [Справочник по классу CChkSGFiles](cchksgfiles-class-reference.md)
- [Концепции резервного копирования и восстановления Exchange 2013 г.](backup-and-restore-concepts-for-exchange-2013.md)
    

