---
title: Типы операций резервного копирования Exchange 2013 г.
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
ms.localizationpriority: medium
ms.assetid: 70510902-9583-4177-be3d-afbf757a1ec0
description: Найдите сведения о различных типах резервных копий, которые можно выполнить в базах данных Exchange 2013 г., включая полные, скопируйте, инкрементные и дифференциальные резервные копии.
ms.openlocfilehash: 79fcdaa40409ee7cac4df44711c1551946b85ca1
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/24/2021
ms.locfileid: "59520257"
---
# <a name="types-of-backup-operations-for-exchange-2013"></a>Типы операций резервного копирования Exchange 2013 г.

Найдите сведения о различных типах резервных копий, которые можно выполнить в базах данных Exchange 2013 г., включая полные, скопируйте, инкрементные и дифференциальные резервные копии.
  
**Применяется к:** Exchange Server 2013 г. 
  
В этой статье данная статья содержит сведения о различных типах резервных копий, которые можно выполнять в базах данных Exchange Server 2013 г., и о том, как эти резервные копии влияют на файлы баз данных. 
  
Резервное копирование и восстановление приложений, которые используют службу копирования теней тома (VSS) и Exchange могут выполнять типы резервных копий, перечисленных в следующей таблице.
  
**Таблица 1. Типы операций резервного копирования**

|**Тип резервного копирования**|**Описание**|
|:-----|:-----|
|[Полное резервное копирование](types-of-backup-operations-for-exchange-2013.md#bk_FullBackups) <br/> |Архивирует базы данных (.edb), журналы транзакций (.log), файлы контрольно-пропускных пунктов (chk), а затем усечены журналы транзакций для \* \* \* определенной базы данных.  <br/> |
|[Копирование резервных копий](types-of-backup-operations-for-exchange-2013.md#bk_CopyBackups) <br/> |Архивная база данных, журналы транзакций и файлы контрольно-пропускных пунктов. Копирование резервных копий не усечено журналами транзакций для базы данных.  <br/> |
|[Дополнительные резервные копии](types-of-backup-operations-for-exchange-2013.md#bk_IncrementalBackups) <br/> |Резервное копирование журналов транзакций для записи изменений после последнего полного или постепенного резервного копирования, а затем усечение журналов транзакций.  <br/> |
|[Резервное копирование дифференциалов](types-of-backup-operations-for-exchange-2013.md#bk_DifferentialBackups) <br/> |Резервное копирование журналов транзакций для записи изменений с момента последнего полного или постепенного резервного копирования и не усечено журналов транзакций.  <br/> |
   
Компоненты или файлы баз данных, определенные автором Exchange, представляют файлы баз данных и журналы транзакций в Exchange 2013 г. Это позволяет приложению резервного копирования и восстановления отображать имена компонентов в базе данных Exchange 2013 г. во время операций резервного копирования. Однако приложение резервного копирования не может резервное копирование отдельных компонентов базы данных; он может только закаметь целые базы данных. 
  
Автор Exchange стандартизирует логические пути компонента базы данных, указанные в метаданных Exchange автора. Автор Exchange возвращает логические пути в резервное копирование и восстановление приложения по мере необходимости.
  
Автор Exchange предоставляет логические пути в форме: 
  
 `logicalPath = "Exchange Server\Microsoft Information Store\<Server name>"`
  
Компоненты сервера и базы данных являются компонентами группы файлов, но у них нет связанных файлов. У них есть подкомпоненты, которые указывают отдельные файлы. База данных содержит только один компонент журнала с именем Журналы. Имена компонентов отдельных компонентов базы данных — это GUID-интерфейсы баз данных, показанные в качестве строк. 
  
Автор Exchange списки баз данных, которые можно получить на основе рекомендаций по основам VSS. Базы данных, установленные в качестве базы данных восстановления Exchange 2013 г., а также базы данных, которые не установлены, не могут быть восстановлены и поэтому не указаны в метаданных Exchange автора.
  
На следующем рисунке показан процесс Exchange резервного копирования записи. 
  
**Рис. 1. Последовательность событий для процесса резервного копирования**

![Диаграмма, показывающая последовательность событий для процесса резервного копирования. Последовательность начинается с запуска хранилищ Exchange, после чего службой записи Exchange, VSS и клиентским приложением выполняется ряд действий.](media/VSS_StoreWriterBackup.gif)
  
## <a name="full-backups"></a>Полное резервное копирование
<a name="bk_FullBackups"> </a>

Полное резервное копирование Exchange базы данных включает создание и хранение копии файла базы данных, журналов транзакций и файлов контрольно-пропускных пунктов. В Exchange 2013 г. имеется один набор выделенных файлов журнала транзакций.
  
После резервного копирования базы данных файлы журнала транзакций на диске усечены, чтобы оставались только изменения базы данных, произошедшие после резервного копирования. Во время этого процесса Exchange удаляет все записи журнала до контрольной точки, исходя из предположения о том, что базы данных теперь были отлажка в согласованном состоянии, содержаном все изменения до последнего контрольно-пропускного пункта. 
  
Если резервное копирование базы данных будет отсеяно во время операции резервного копирования, Exchange 2013 г. журналы транзакций не будут усечены, и результат будет эквивалентом операции резервного копирования копии, а не полной операции резервного копирования. 
  
Когда полное резервное копирование завершено, заглавные главы активной монтируется базы данных обновляются с текущей информацией резервного копирования. В реплицируемых развертываниях эта информация будет перенавязана в файл журнала транзакций и реплицирована в другие копии базы данных DAG. Главы копий баз данных обновляются по мере воспроизведения этого файла журнала транзакций в копию базы данных.
  
Для запуска дополнительных или дифференциальных резервных копий теневых копий требуется полная теневая копия. Полное резервное копирование может быть взято из любой копии до тех пор, пока это резервное копирование теневой копии.
  
Полные резервные копии используются в следующих сценариях:
  
- База данных повреждена или потеряна, но файлы журнала транзакций на диске не повреждены. В этом сценарии затронутые файлы баз данных могут быть восстановлены из полного резервного копирования, а затем восстановлены путем воспроизведения журналов транзакций, которые по-прежнему находятся на диске. 
    
- Файлы журнала транзакций, а также файл базы данных на диске теряются. В этом сценарии вместе с базой данных восстанавливаются файлы журнала транзакций, резервное копирование в момент полного резервного копирования.
    
В Exchange 2013 г. журналы можно восстановить без восстановления применимой базы данных из полного набора резервного копирования. Этот параметр позволяет восстановить предыдущую полную резервную копию и объединить ее с файлами журнала транзакций из последнего полного резервного копирования для продвижения вперед.
  
Если [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS задается VSS_BT_FULL,  когда Exchange выполняет резервное копирование, в резервное копирование включаются следующие компоненты: 
  
- База данных с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\> 
    
- Файл журнала с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\> 
    
## <a name="copy-backups"></a>Копирование резервных копий
<a name="bk_CopyBackups"> </a>

Копирование резервного копирования Exchange базы данных включает создание и хранение тех же элементов, которые включены в полное резервное копирование. Однако, в отличие от полного резервного копирования, файлы журнала транзакций на диске не усечены по завершению резервного копирования. Копирование резервных копий не предназначено для целей восстановления данных. Вместо этого копии резервного копирования предоставляют изображение данных для использования в тестировании, диагностике проблем или для посева реплики.
  
Например, администратор Exchange 2013 г., у которого возникли проблемы с хранилищем Exchange, может сделать копию резервного копирования для использования в тестовой среде, не затрагивая производственную систему. Копирование резервных копий не влияет на регулярные графики резервного копирования; однако, так как резервное копирование также помещает хранилище Exchange в состояние резервного копирования, оно блокирует выполнение других запланированных резервных копий до завершения или сбоя резервного копирования. 
  
Если [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS установлено **VSS_BT_COPY,** в копию резервного копирования включаются следующие компоненты: 
  
- База данных с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\> 
    
- Компонент файла журнала с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\>
    
## <a name="incremental-backups"></a>Дополнительные резервные копии
<a name="bk_IncrementalBackups"> </a>

Постепенное резервное копирование базы данных Exchange 2013 г. сохраняет изменения в базе данных, которые произошли с момента последнего полного или постепенного резервного копирования. Когда все файлы баз данных и файлы журналов будут восстановлены в системе, они могут быть восстановлены до состояния, в который они были во время последнего постепенного резервного копирования. Данные, хранимые в инкрементной резервной копии, включают только файлы журнала транзакций до текущего времени. 
  
После завершения резервного копирования сервер Exchange усечены файлы журналов и отмечает время резервного копирования в заголовках баз данных. Для восстановления базы данных с помощью дополнительного резервного копирования требуется восстановить по крайней мере два набора данных: последнее полное резервное копирование, а затем каждое дополнительное резервное копирование после последнего полного резервного копирования. Преимуществом для использования дополнительных резервных копий является то, что отдельные резервные копии намного меньше, чем полное резервное копирование, а отдельные дополнительные резервные копии часто меньше, чем дифференциальные резервные копии. 
  
Недостатком использования дополнительных резервных копий является то, что если между полными резервными копиями было выполнено много дополнительных резервных копий, восстановление Exchange может потребовать восстановления многих дополнительных резервных копий. Exchange не позволяет создавать дополнительные резервные копии, если не существует предыдущего полного резервного копирования, чтобы установить отправную точку для дополнительных изменений. 
  
Полное резервное копирование, взятая из расположения копии DAG, может быть последовано за дополнительным резервной копией из активного расположения и наоборот. Одно из ограничений, которые необходимо иметь в виду, это то, что последнее состояние резервного копирования поддерживается в загоне активной базы данных, а изменения в загоне баз данных записывались в журналы транзакций, реплицированы и повторялись в расположении базы данных копирования, как и все другие журналы транзакций в развертываниях DAG. Поскольку резервное копирование и восстановление интероперации, приложения резервного копирования могут предоставлять функции для запуска резервных копий исключительно на определенном узле DAG независимо от того, является ли узел активным или пассивным, а также запускать резервные копии исключительно из пассивного узла или исключительно из активного узла.
  
Если [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS установлено **VSS_BT_INCREMENTAL,** следующие компоненты включаются в дополнительный резерв: 
  
- База данных с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\> 
    
- Файл журнала с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\>
    
## <a name="differential-backups"></a>Резервное копирование дифференциалов
<a name="bk_DifferentialBackups"> </a>

Дифференциальное резервное копирование базы данных Exchange 2013 г. сохраняет изменения в базе данных, которые произошли с момента последнего полного или постепенного резервного копирования. Когда системы восстанавливают файлы баз данных и файлы журналов, они могут быть восстановлены до состояния, в который они были в последнем резервном копировании дифференциала. 
  
Данные, хранимые в резервной копии дифференциала, включают только файлы журнала транзакций до текущего контрольно-пропускного пункта. Дифференциальные резервные копии не удаляют и не изменяют файлы журналов и не изменяют заглавные записи баз данных. Чтобы восстановить базу данных с помощью дифференциального резервного копирования, необходимо восстановить только два набора данных: последнее полное резервное копирование и последнее резервное копирование дифференциала. 
  
Недостатком использования дифференциальных резервных копий является то, что дифференциальные резервные копии дублируют резервное копирование данных в каждом резервном копировании до полного выполнения резервного копирования. Если между полными резервными копиями будет взято много различных резервных копий, необходимое пространство хранилища может превышать требуемую при том же количестве дополнительных резервных копий. Exchange не позволяет создавать дифференциальное резервное копирование, если не было полного или постепенного резервного копирования для создания отправной точки для дифференциальных резервных копий.
  
Полное резервное копирование, взятого из расположения копии, может быть последовано за дифференциальной резервной копией от активного расположения и наоборот. Одно из ограничений, которые необходимо иметь в виду, это то, что последнее состояние резервного копирования поддерживается в загоне активной базы данных, а изменения в загоне баз данных записывались в журналы транзакций, реплицированы и повторялись в расположении базы данных копирования, как и все другие журналы транзакций в развертываниях DAG. Поскольку резервное копирование и восстановление интероперата, приложения резервного копирования предоставляют функции для запуска всех резервных копий исключительно на определенном узле DAG независимо от того, является ли узел активным или пассивным, а также для запуска резервных копий исключительно из пассивного узла или исключительно из активного узла.
  
Если [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) в VSS установлено **VSS_BT_DIFFERENTIAL,** следующие компоненты включаются в дифференциальное резервное копирование: 
  
- База данных с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\> 
    
- Файл журнала с логическим путем Exchange Server\Microsoft Information Store \\<имя сервера<\> \\ GUID базы данных\>
    
## <a name="see-also"></a>См. также
<a name="bk_AdditionalResources"> </a>

- [Создание приложений резервного копирования и восстановления для Exchange 2013 г.](build-backup-and-restore-applications-for-exchange-2013.md)
    
- [Концепции резервного копирования и восстановления Exchange 2013 г.](backup-and-restore-concepts-for-exchange-2013.md)
    
- [Восстановление Exchange 2013 г.](restoring-exchange-2013-databases.md)
    
- [Проверка целостности резервного копирования с помощью API CHKSGFILES в Exchange 2013 г.](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
    
- [Проверка целостности резервного копирования с помощью средства Eseutil в Exchange 2013 г.](how-to-validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013.md)
    

